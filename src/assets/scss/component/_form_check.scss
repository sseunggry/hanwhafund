@use 'sass:map';
@use "../util" as *;

/* 라디오 버튼 / 체크박스 */
input[type='radio'],
input[type='checkbox'] {
  @include sr-only;
}

label {
  display: inline-flex;
}

.#{$prefix}-check-area {
  display: flex;
  gap: var(--#{$prefix}-gap-6);

  &.chk-column {
    flex-direction: column;
  }
	&.full{
		width: 100%;

		label{
			width: 100%;
			span{
				width: 100%;
			}
		}
	}
}

// .chip-wrap {
//   @include flex-layout($jc: space-between);

//   gap: var(--#{$prefix}-number-5);

//   .#{$prefix}-form-chip {
//     flex: 1;

//     .radio {
//       &:not(:checked) {
//         ~ .#{$prefix}-form-chip-outline {
//           &::before {
//             display: none;
//           }
//         }
//       }

//       ~ .#{$prefix}-form-chip-outline {
//         justify-content: center;
//         width: 100%;
//         padding: 0;
//       }
//     }
//   }
// }

// 사이즈 정의
@mixin form-check-size-variable() {
  // 변수 배열 설정
  $form-check-size: (
		small: (
			button-size: var(--#{$prefix}-size-xxsmall),
			radio-check-size: 1.6rem,
			checkbox-check-size: 1.6rem,
			check-icon-size: var(--#{$prefix}-size-xxxsmall),
			checkbox-button-radius: var(--#{$prefix}-radius-xsmall),
			large-font-size: var(--#{$prefix}-large-font-size-label-small),
      medium-font-size: var(--#{$prefix}-medium-font-size-label-small),
      small-font-size: var(--#{$prefix}-small-font-size-label-small),
		),
    medium: (
      button-size: var(--#{$prefix}-size-xxsmall),
      radio-check-size: 1rem,
      checkbox-check-size: 1.2rem,
      check-icon-size: var(--#{$prefix}-size-xxsmall),
      radio-button-radius: var(--#{$prefix}-radius-max),
      checkbox-button-radius: var(--#{$prefix}-radius-xsmall),
      large-font-size: var(--#{$prefix}-large-font-size-label-medium),
      medium-font-size: var(--#{$prefix}-medium-font-size-label-medium),
      small-font-size: var(--#{$prefix}-small-font-size-label-medium),
      additional-text-large-font-size: var(--#{$prefix}-large-font-size-label-small),
      additional-text-medium-font-size: var(--#{$prefix}-mobile-font-size-label-small),
      additional-text-small-font-size: var(--#{$prefix}-mobile-font-size-label-small),
    ),
    large: (
      button-size: var(--#{$prefix}-size-xsmall),
      radio-check-size: 1.2rem,
      checkbox-check-size: var(--#{$prefix}-size-xxxsmall),
			check-icon-size: var(--#{$prefix}-size-xsmall),
      radio-button-radius: var(--#{$prefix}-radius-max),
      checkbox-button-radius: var(--#{$prefix}-radius-xsmall),
      large-font-size: var(--#{$prefix}-large-font-size-label-large),
      medium-font-size: var(--#{$prefix}-medium-font-size-label-large),
      small-font-size: var(--#{$prefix}-small-font-size-label-large),
      additional-text-large-font-size: var(--#{$prefix}-large-font-size-label-medium),
      additional-text-medium-font-size: var(--#{$prefix}-medium-font-size-label-medium),
      additional-text-small-font-size: var(--#{$prefix}-small-font-size-label-medium),
    ),
  ) !default;

  // css variable 생성
  @each $size, $types in $form-check-size {
    @each $type, $value in $types {
      // css variable 생성
      --#{$prefix}-form-check--#{$type}-#{$size}: #{$value};
    }
  }

  --#{$prefix}-form-check--gap: var(--#{$prefix}-gap-3);
  // --#{$prefix}-form-check--button-margin-top: 0.3rem;
  --#{$prefix}-form-check--button-margin-top: 0;

  // class 정의
  & {
    // 사이즈 별 class
    @each $size, $types in $form-check-size {
      &.#{$size} {
        > input[type='radio'],
        > input[type='checkbox'] {
          ~ label {
            @include form-check(#{$size});

            &::before {
              @include form-check-button(#{$size});
            }

            + .#{$prefix}-form-check-cnt {
              @include form-check-additional-text(#{$size});
            }
          }
        }

        // radio button
        > input[type='radio'] {
          ~ label {
            &::before {
              @include form-check-radio-button(#{$size});
            }

            &::after {
              @include form-check-radio-check(#{$size});
            }
          }
        }

        // checkbox
        > input[type='checkbox'] {
          ~ label {
            &::before {
              @include form-check-checkbox-button(#{$size});
            }

            &::after {
              @include form-check-checkbox-check(#{$size}, $mode: map.get($modes, 'light'));
            }
          }
        }

				&.icon-right{
					> input[type='radio'] {
						~ label {
							&::before {
								order: 1;
							}

							&::after {
								@include form-check-radio-check(#{$size}, $pos: right);
							}
						}
					}
					> input[type='checkbox'] {
						~ label {
							&::before {
								order: 1;
							}

							&::after {
								@include form-check-checkbox-check-right(#{$size});
							}
						}
					}
				}
				&.check-icon {
					> input[type='checkbox'] {
						~ label {
							&::after {
								@include form-check-checkbox-check(#{$size}, $checkIcon: true);
							}
						}
					}

					&.icon-right{
						> input[type='checkbox'] {
							~ label {
								&::after {
									@include form-check-checkbox-check-right(#{$size}, $checkIcon: true);
								}
							}
						}
					}
				}
      }
    }
  }
}

// checkbox radio 공통 사이즈 정의
@mixin form-check($size) {
  gap: var(--#{$prefix}-form-check--gap);
  font-size: var(--#{$prefix}-form-check--large-font-size-#{$size});

	@include size-medium-to-large {
		font-size: var(--#{$prefix}-form-check--medium-font-size-#{$size});
	}
	
  @include size-medium {
    font-size: var(--#{$prefix}-form-check--small-font-size-#{$size});
  }
}

// checkbox radio ::before 공통 사이즈 정의
@mixin form-check-button($size) {
  @include square(var(--#{$prefix}-form-check--button-size-#{$size}));

  margin-top: var(--#{$prefix}-form-check--button-margin-top);
}

// radio ::before 사이즈 정의
@mixin form-check-radio-button($size) {
  border-radius: var(--#{$prefix}-form-check--radio-button-radius-#{$size});
}

// radio ::after 사이즈 정의
@mixin form-check-radio-check($size, $pos: left) {
  // 포지션: (전체사이즈 - 체크영역) / 2
	top: 50%;
  // top: calc((var(--#{$prefix}-form-check--button-size-#{$size}) - var(--#{$prefix}-form-check--radio-check-size-#{$size})) / 2 + var(--#{$prefix}-form-check--button-margin-top));
  left: calc((var(--#{$prefix}-form-check--button-size-#{$size}) - var(--#{$prefix}-form-check--radio-check-size-#{$size})) / 2);
	transform: translateY(-50%);

	@include square(var(--#{$prefix}-form-check--radio-check-size-#{$size}));

  // background-color: var(--#{$prefix}-form-check--radio-check-color-element);
  border-radius: var(--#{$prefix}-radius-max);

	@if $pos == right {
		left: auto;
		right: calc((var(--#{$prefix}-form-check--button-size-#{$size}) - var(--#{$prefix}-form-check--radio-check-size-#{$size})) / 2);
	}
}

// checkbox ::before 사이즈 정의
@mixin form-check-checkbox-button($size) {
  border-radius: var(--#{$prefix}-form-check--checkbox-button-radius-#{$size});
}

// checkbox ::after 사이즈 정의
@mixin form-check-checkbox-check($size, $mode: light, $checkIcon: false) {
  // 포지션: (전체사이즈 - 체크영역) / 2
	--form-check-check-size: var(--#{$prefix}-form-check--checkbox-check-size-#{$size});
	--form-check-color: var(--#{$prefix}-form-check--checkbox-check-color-element);

	@if $checkIcon {
		--form-check-check-size : var(--#{$prefix}-form-check--check-icon-size-#{$size});
		--form-check-color: var(--#{$prefix}-form-check--check-icon-color-element);
	}

	top: 50%;
	// top: calc((var(--#{$prefix}-form-check--button-size-#{$size}) - var(--form-check-check-size)) / 2 + var(--#{$prefix}-form-check--button-margin-top));
	left: calc((var(--#{$prefix}-form-check--button-size-#{$size}) - var(--form-check-check-size)) / 2);
	transform: translateY(-50%);
	
	@include svg-icon($size: var(--form-check-check-size), $mode: #{$mode});
	@include icon-set(ico_checkbox_checked);

	background-color: var(--form-check-color);
}

@mixin form-check-checkbox-check-right($size, $checkIcon: false, $pos: right) {
	--form-check-check-size: var(--#{$prefix}-form-check--checkbox-check-size-#{$size});

	@if $checkIcon {
		--form-check-check-size : var(--#{$prefix}-form-check--check-icon-size-#{$size});
	} 
	left: auto;
	right: calc((var(--#{$prefix}-form-check--button-size-#{$size}) - var(--form-check-check-size)) / 2);
}

// form 부가설명 사이즈 정의
@mixin form-check-additional-text($size) {
  padding-left: calc(var(--#{$prefix}-form-check--button-size-#{$size}) + var(--#{$prefix}-form-check--gap));

  .#{$prefix}-form-check-p {
    font-size: var(--#{$prefix}-form-check--additional-text-large-font-size-#{$size});

    @include size-medium-to-large {
			font-size: var(--#{$prefix}-form-check--additional-text-medium-font-size-#{$size});
		}
    @include size-medium {
      font-size: var(--#{$prefix}-form-check--additional-text-small-font-size-#{$size});
    }
  }
}

// 컬러 정의
@mixin form-check-color-variable($mode: light) {
  --#{$prefix}-form-check--color-text: var(--#{$prefix}-#{$mode}-color-text-bolder);
  --#{$prefix}-form-check--color-text-disabled: var(--#{$prefix}-#{$mode}-color-text-disabled);
  --#{$prefix}-form-check--color-text-sub: var(--#{$prefix}-#{$mode}-color-text-subtle);
  --#{$prefix}-form-check--color-text-sub-disabled: var(--#{$prefix}-#{$mode}-color-text-disabled);
  --#{$prefix}-form-check--button-color-element: var(--#{$prefix}-#{$mode}-color-element-white);
  --#{$prefix}-form-check--button-color-element-disabled: var(--#{$prefix}-#{$mode}-color-element-disabled);
  --#{$prefix}-form-check--button-color-border: var(--#{$prefix}-#{$mode}-color-border-neutral);
  --#{$prefix}-form-check--button-color-border-checked: var(--#{$prefix}-#{$mode}-color-element-primary);
  --#{$prefix}-form-check--button-color-border-disabled: var(--#{$prefix}-#{$mode}-color-border-disabled);
  --#{$prefix}-form-check--checkbox-button-color-element-checked: var(--#{$prefix}-#{$mode}-color-element-primary);
  --#{$prefix}-form-check--radio-check-color-element: var(--#{$prefix}-#{$mode}-color-element-white);
  --#{$prefix}-form-check--radio-check-color-element-checked: var(--#{$prefix}-#{$mode}-color-element-primary);
  --#{$prefix}-form-check--radio-check-color-element-disabled: var(--#{$prefix}-#{$mode}-color-element-disabled-on);
  --#{$prefix}-form-check--checkbox-check-color-element: var(--#{$prefix}-#{$mode}-color-element-white);
  --#{$prefix}-form-check--checkbox-check-color-element-checked: var(--#{$prefix}-#{$mode}-color-element-white);
  --#{$prefix}-form-check--checkbox-check-color-element-disabled: var(--#{$prefix}-#{$mode}-color-element-disabled);
  --#{$prefix}-form-check--checkbox-check-color-element-checked-disabled: var(--#{$prefix}-#{$mode}-color-element-disabled-on);
  --#{$prefix}-form-check--check-icon-button-color-element: var(--#{$prefix}-#{$mode}-color-element-white);
  --#{$prefix}-form-check--check-icon-button-color-border: var(--#{$prefix}-#{$mode}-color-element-white);
  --#{$prefix}-form-check--check-icon-color-element: var(--#{$prefix}-#{$mode}-color-element-disabled);
  --#{$prefix}-form-check--check-icon-color-element-checked: var(--#{$prefix}-#{$mode}-color-element-primary);
  --#{$prefix}-form-check--check-icon-color-element-disabled: var(--#{$prefix}-#{$mode}-color-element-disabled);
  --#{$prefix}-form-check--additional-text-color-text: var(--#{$prefix}-#{$mode}-color-text-subtle);
}

.#{$prefix}-form-check {
  @include form-check-color-variable(map.get($modes, 'light'));
  @include form-check-size-variable;

  $size: medium;

  input[type='radio'],
  input[type='checkbox'] {
    ~ label {
      position: relative;
      display: inline-flex;
			align-items: center;
			// width: 100%;

      @include form-check(#{$size});

      &::before,
      &::after {
        display: flex;

        @include pseudo;

        transition: 0.4s cubic-bezier(0.4, 0, 0.23, 1);
      }

      &::before {
        flex-shrink: 0;

        @include form-check-button(#{$size});

        z-index: 3;
        background-color: var(--#{$prefix}-form-check--button-color-element);
        border: 0.1rem solid var(--#{$prefix}-form-check--button-color-border);
      }

      &::after {
        position: absolute;
        z-index: 4;
      }

			span{
				width: 100%;
			}
    }

    &:disabled {
      ~ label {
        color: var(--#{$prefix}-form-check--color-text-sub-disabled);
        cursor: default;

        &::before {
          background-color: var(--#{$prefix}-form-check--button-color-element-disabled);
          border-color: var(--#{$prefix}-form-check--button-color-border-disabled);
        }
      }
    }

    &:focus {
      ~ label {
        @include focus($offset: 0.4rem);
      }
    }
  }

  // radio button
  input[type='radio'] {
    ~ label {
      &::before {
        @include form-check-radio-button(#{$size});
      }

      &::after {
        @include form-check-radio-check(#{$size});
      }
    }

    &:checked {
      ~ label {
        &::before {
          border-color: var(--#{$prefix}-form-check--button-color-border-checked);
        }

        &::after {
          background-color: var(--#{$prefix}-form-check--radio-check-color-element-checked);
        }
      }

      &:disabled {
        ~ label {
					&::before {
						border-color: var(--#{$prefix}-form-check--button-color-border-disabled);
					}
          &::after {
            background-color: var(--#{$prefix}-form-check--radio-check-color-element-disabled);
          }
        }
      }
    }
  }

  // checkbox
  input[type='checkbox'] {
    ~ label {
      &::before {
        @include form-check-checkbox-button(#{$size});
      }

      &::after {
        @include form-check-checkbox-check(#{$size}, $mode: map.get($modes, 'light'));
      }
    }

    &:checked {
      ~ label {
        &::before {
          background-color: var(--#{$prefix}-form-check--checkbox-button-color-element-checked);
          border-color: var(--#{$prefix}-form-check--button-color-border-checked);
        }

        &::after {
          background-color: var(--#{$prefix}-form-check--checkbox-check-color-element-checked);
          transition-delay: 0.1s;
        }
      }

      &:disabled {
        ~ label {
          &::after {
            background-color: var(--#{$prefix}-form-check--checkbox-check-color-element-checked-disabled);
          }
        }
      }
    }
		&:disabled {
			~ label {
				&::before {
          background-color: var(--#{$prefix}-form-check--button-color-element-disabled);
          border-color: var(--#{$prefix}-form-check--button-color-border-disabled);
        }
				&::after {
					background-color: var(--#{$prefix}-form-check--checkbox-check-color-element-disabled);
				}
			}
		}
		&:indeterminate {
			~ label {
				&::before{
					background-color: var(--#{$prefix}-form-check--checkbox-button-color-element-checked);
					border-color: var(--#{$prefix}-form-check--button-color-border-checked);
				}
				&::after {
					@include icon-set(ico_checkbox_indeterminate);
					background-color: var(--#{$prefix}-form-check--checkbox-check-color-element);

				}
			}

			&:disabled {
				~ label {
					&::before {
						background-color: var(--#{$prefix}-form-check--button-color-element-disabled);
						border-color: var(--#{$prefix}-form-check--button-color-border-disabled);
					}
					&::after {
						background-color: var(--#{$prefix}-form-check--checkbox-check-color-element-checked-disabled);
					}
				}
			}
		}
  }

	&.check-icon {
		input[type='checkbox'] {
			~ label {
				&::before {
					border: var(--#{$prefix}-form-check--check-icon-button-color-border);
				}
	
				&::after {
					background-color: var(--#{$prefix}-form-check--check-icon-color-element);
				}
			}
	
			&:checked {
				~ label {
					&::before {
						background-color: var(--#{$prefix}-form-check--check-icon-button-color-element);
					}
	
					&::after {
						background-color: var(--#{$prefix}-form-check--check-icon-color-element-checked);
					}
				}
	
				&:disabled {
					~ label {
						&::after {
							background-color: var(--#{$prefix}-form-check--check-icon-color-element-disabled);
						}
					}
				}
			}
			&:disabled {
				~ label {
					&::before {
						background-color: var(--#{$prefix}-form-check--check-icon-button-color-element);
					}
					&::after {
						background-color: var(--#{$prefix}-form-check--check-icon-color-element-disabled);
					}
				}
			}
		}

	}

  // 부가설명
  .#{$prefix}-form-check-cnt {
    margin-top: var(--#{$prefix}-padding-2);

    .#{$prefix}-form-check-p {
      color: var(--#{$prefix}-form-check--additional-text-color-text);
    }
  }
}

// 고대비모드
@include color-mode($mode: high-contrast) {
  .#{$prefix}-form-check {
    @include form-check-color-variable(map.get($modes, 'high-contrast'));
    @include form-check-size-variable;

    $size: medium;

    // checkbox
    input[type='checkbox'] {
      ~ label {
        &::after {
          @include form-check-checkbox-check(#{$size}, $mode: map.get($modes, 'high-contrast'));
        }
      }

      &:checked {
        ~ label {
          &::after {
            background-color: var(--#{$prefix}-form-check--checkbox-check-color-element-checked);
            transition-delay: 0.1s;
          }
        }

        &:disabled {
          ~ label {
            &::after {
              background-color: var(--#{$prefix}-form-check--checkbox-check-color-element-disabled);
            }
          }
        }
      }
    }

    // radio button
    input[type='radio'] {
      &:checked {
        ~ label {
          &::before {
            border-color: var(--#{$prefix}-form-check--button-color-border-checked);
          }

          &::after {
            background-color: var(--#{$prefix}-form-check--radio-check-color-element-checked);
          }
        }

        &:disabled {
          ~ label {
            &::after {
              background-color: var(--#{$prefix}-form-check--radio-check-color-element-disabled);
            }
          }
        }
      }
    }
  }
}
