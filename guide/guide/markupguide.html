<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>마크업 가이드</title>
    <link href="../script_guide/css/index.css" rel="stylesheet" />
    <style>
      #treemenu ul {
        list-style: none;
        padding-left: 15px; /* 들여쓰기 */
      }
      #treemenu .category > span {
        font-weight: bold;
        cursor: default; /* 클릭 기능 없으면 */
        display: block;
        margin-top: 10px;
      }
      #treemenu .sub-items {
        padding-left: 10px; /* 하위 항목 들여쓰기 */
        margin-top: 5px;
      }
      #treemenu a {
        text-decoration: none;
        color: #333;
        display: block;
        padding: 3px 0;
      }
      #treemenu a:hover {
        text-decoration: underline;
        color: #007bff;
      }
      #treemenu a.active {
        /* 현재 활성화된 링크 스타일 */
        font-weight: bold;
        color: #0056b3;
      }
      #treemenu a.status-complete::after {
        /* 완료 상태 표시 예시 */
        content: " ✔";
        color: green;
        font-size: 0.8em;
      }
    </style>
  </head>

  <body>
    <div id="wrap">
      <header id="header">
        <div class="inner">
          <h1 class="title">삼성화재 마크업 가이드</h1>
          <ul class="nav" id="topNav">
            <li>
              <a href="/v2/guide/guide/markupguide.html">마크업 가이드</a>
            </li>
          </ul>
        </div>
      </header>
      <div id="contents">
        <div class="side_nav" id="sideNav">
          <div id="pages">
            <div id="markupGuide">
              <h2 class="side_title">마크업 가이드</h2>
              <div id="treemenu"></div>
            </div>
          </div>
        </div>
        <div class="contents">
          <iframe
            class="content_frame"
            id="content_frame"
            name="content_frame"
          ></iframe>
          <script>
            const treeContainer = document.getElementById("treemenu");
            const iframe = document.getElementById("content_frame");
            const data = {
              가이드: {
                가이드: ["/v2/guide/guide/guide.html", "complete"],
              },

              엘리먼트: {
                클래스규칙: ["/v2/guide/guide/ele_class.html", "complete"],
                타이포그래피: ["/v2/guide/guide/ele_typo.html", "complete"],
                뱃지: ["/v2/guide/guide/ele_badge.html", "complete"],
              },

              모듈: {
                탭: ["/v2/guide/guide/mod_tabs.html", "complete"],
                아코디언: ["/v2/guide/guide/mod_accordions.html", "complete"],
                목록: ["/v2/guide/guide/mod_lists.html", "complete"],
                인디케이터: ["/v2/guide/guide/mod_indicators.html", "complete"],
                모듈박스: ["/v2/guide/guide/mod_moduleboxs.html", "complete"],
                테이블: ["/v2/guide/guide/mod_tables.html", "complete"],
                정보동의: ["/v2/guide/guide/mod_agrees.html", "complete"],
                프로세스: ["/v2/guide/guide/mod_process.html", "complete"],
                슬라이더: ["/v2/guide/guide/mod_sliders.html", "complete"],
              },

              폼: {
                버튼: ["/v2/guide/guide/form_buttons.html", "complete"],
                "텍스트 필드": ["/v2/guide/guide/form_inputs.html", "complete"],
                셀렉트박스: ["/v2/guide/guide/form_selects.html", "complete"],
                달력: ["/v2/guide/guide/form_calendar.html", "complete"],
                파일첨부: ["/v2/guide/guide/form_files.html", "complete"],
                스위치: ["/v2/guide/guide/form_switch.html", "complete"],
                체크박스: ["/v2/guide/guide/form_checks.html", "complete"],
                라디오버튼: ["/v2/guide/guide/form_radios.html", "complete"],
                폼조합: ["/v2/guide/guide/form_combine.html", "complete"],
              },

              레이아웃: {
                타이틀영역: ["/v2/guide/guide/layout_title.html", "complete"],
                브레드크럼: [
                  "/v2/guide/guide/layout_breadcrumb.html",
                  "complete",
                ],
                영역: ["/v2/guide/guide/layout_dividers.html", "complete"],
                로딩: ["/v2/guide/guide/layout_loadings.html", "complete"],
                로띠: ["/v2/guide/guide/layout_lotties.html", "complete"],
              },
            };

            // 트리 메뉴 HTML 생성 함수
            function createTreeMenu(container, treeData, frameId) {
              if (!container || !treeData || !frameId) return; // 필수 요소 없으면 종료

              const rootUl = document.createElement("ul");
              rootUl.id = "tree2"; // MOui 옵션의 idName 적용 (선택사항)

              // 데이터 객체를 순회하며 리스트 생성
              for (const category in treeData) {
                const categoryLi = document.createElement("li");
                categoryLi.classList.add("category"); // 스타일링 위한 클래스

                // 카테고리명 표시 (클릭 가능하게 하려면 span 대신 button 등으로 변경 가능)
                const categorySpan = document.createElement("span");
                categorySpan.textContent = category;
                categoryLi.appendChild(categorySpan);

                const subUl = document.createElement("ul"); // 하위 목록 ul
                subUl.classList.add("sub-items");

                // 카테고리 내 항목 순회
                for (const subItemName in treeData[category]) {
                  const itemData = treeData[category][subItemName];
                  const url = itemData[0]; // 링크 URL
                  const status = itemData[1] || ""; // 상태 (없으면 빈 문자열)

                  const subLi = document.createElement("li");
                  const link = document.createElement("a");

                  link.href = url; // 링크 URL 설정
                  link.textContent = subItemName; // 링크 텍스트
                  link.target = frameId; // iframe의 name 속성값으로 타겟 지정

                  // 상태에 따른 클래스 추가 (선택사항)
                  if (status === "complete") {
                    link.classList.add("status-complete");
                  } else if (status) {
                    // 다른 상태값도 클래스로 추가 가능
                    link.classList.add(`status-${status}`);
                  }

                  subLi.appendChild(link);
                  subUl.appendChild(subLi);
                }

                categoryLi.appendChild(subUl);
                rootUl.appendChild(categoryLi);
              }
              container.appendChild(rootUl); // 생성된 트리를 컨테이너에 추가

              // (선택사항) 현재 페이지에 해당하는 링크 활성화 기능
              highlightActiveLink(rootUl, frameId);
            }

            // (선택사항) iframe 로드 시 해당 링크 활성화 함수
            function highlightActiveLink(treeRoot, frameId) {
              const frame = document.getElementById(frameId);
              if (!frame) return;

              frame.addEventListener("load", function () {
                const currentFrameSrc =
                  frame.contentWindow.location.pathname +
                  frame.contentWindow.location.search; // iframe 내부 경로
                const allLinks = treeRoot.querySelectorAll("a");

                allLinks.forEach((link) => {
                  // link.pathname은 전체 URL에서 경로만 추출
                  if (link.pathname === currentFrameSrc) {
                    link.classList.add("active"); // 활성 클래스 추가
                  } else {
                    link.classList.remove("active"); // 비활성 클래스 제거
                  }
                });
              });
            }

            // --- 스크립트 실행 ---
            if (treeContainer && iframe) {
              createTreeMenu(treeContainer, data, iframe.name); // name 속성값('content_frame') 전달

              // 초기 iframe 로드 (예: 첫 번째 링크)
              const firstLink = treeContainer.querySelector("ul ul li a");
              if (firstLink && firstLink.href) {
                iframe.src = firstLink.href;
              }
            } else {
              console.error("Tree container or iframe not found!");
            }
          </script>
        </div>
      </div>
    </div>
  </body>
</html>
